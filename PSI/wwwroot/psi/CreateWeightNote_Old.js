var CreateWeightNotePageClass = /** @class */ (function () {
    function CreateWeightNotePageClass(baseUrl) {
        if (baseUrl === void 0) { baseUrl = ""; }
        this.BaseUrl = baseUrl;
    }
    CreateWeightNotePageClass.prototype.IniPageEvent = function () {
        // Page Field
        var fullWeight = $('#VE_PurchaseWeightNote_FullWeightTime').get(0);
        var defectiveWeight = $('#VE_PurchaseWeightNote_DefectiveWeight').get(0);
        var unitPrice = $('#VE_PurchaseWeightNote_UnitPrice').get(0);
        var traficUnitPrice = $('#VE_PurchaseWeightNote_TraficUnitPrice').get(0);
        var weightFee = $('#VE_PurchaseWeightNote_ThirdWeightFee').get(0);
        var ishasTaxList = $(".ishas_tax").get();
        // Logic        
        //fullWeight.addEventListener('keyup', this.CaculateAllFee);
        //defectiveWeight.addEventListener('keyup', this.CaculateAllFee);
        //unitPrice.addEventListener('keyup', this.CaculateAllFee);
        //traficUnitPrice.addEventListener('keyup', this.CaculateAllFee);
        //weightFee.addEventListener('keyup', this.CaculateAllFee);
        //ishasTaxList.forEach((item) => item.addEventListener('change', this.CaculateAllFee));
    };
    ;
    CreateWeightNotePageClass.prototype.ReSetCarNoItems = function (carNoIdObj, dataObjLs) {
        carNoIdObj.html(''); // 選項清空
        var defaultOption = new Option("0.新車牌", "0", false, false);
        carNoIdObj.append(defaultOption);
        dataObjLs.forEach(function (item) {
            var newOption = new Option(item.carName, item.id, false, false);
            carNoIdObj.append(newOption);
        });
    };
    CreateWeightNotePageClass.prototype.ShowList = function () {
        // 傳入結果 根據結果檢查是否為新增不為新增的則Pass，不再保留清單的則移除
        var _this = this;
        //let userSelect = ($('.select2bs4').find(':selected').get() as HTMLSelectElement[]);
        // User畫面所選
        var userSelect = $('.select2bs4').find(':selected').toArray();
        // 準備要Show
        var showList = $('#evenProductLs li').toArray().concat($('#oddProductLs li').toArray());
        // 要新增的就新增
        userSelect.filter(function (item) {
            return showList.map(function (litag) { return litag.dataset.value; }).indexOf(item.value) === -1;
        }).forEach(function (item) { return _this.AppendToShowList(item); });
        // 要刪除的就刪除    
        showList.filter(function (litag) {
            return userSelect.map(function (item) { return item.value; }).indexOf(litag.dataset.value) === -1;
        }).forEach(function (item) { return item.remove(); });
    };
    CreateWeightNotePageClass.prototype.ShowList2 = function (userSelectedVals, evenProductLiTagLs, oddProductLiTagLs) {
        // 傳入結果 根據結果檢查是否為新增不為新增的則Pass，不再保留清單的則移除
        // User畫面所選
        var userSelect = $('.select2bs4').find(':selected').toArray();
        var userSelect2 = $('.select2bs4').find(':selected').toArray()
            .map(function (item) { return item.value; });
        // 差集
        // 要新增的就新增
        //userSelect.filter(item => {
        //    return showList.map(litag => litag.dataset.value).indexOf(item.value) === -1;
        //}).forEach((item) => this.AppendToShowList(item));
        console.log(userSelect2);
    };
    CreateWeightNotePageClass.prototype.GetShowProdItemIds = function (evenProductLiTags, oddProductLiTags) {
        // $("#oddProductLs li").toArray()
        var allShowLiTags = evenProductLiTags.concat(oddProductLiTags);
        if (allShowLiTags)
            return allShowLiTags.map(function (item) { return item.dataset.value; });
    };
    CreateWeightNotePageClass.prototype.AppendToShowList = function (prodItem) {
        var allShowList = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
        var iMinusTag = document.createElement("i");
        iMinusTag.classList.add("fas");
        iMinusTag.classList.add("fa-minus-circle");
        iMinusTag.style.cursor = "pointer";
        iMinusTag.style.color = "blue";
        var iPlusTag = document.createElement("i");
        iPlusTag.classList.add("fas");
        iPlusTag.classList.add("fa-plus-circle");
        iPlusTag.style.cursor = "pointer";
        iPlusTag.style.color = "red";
        var spanTag = document.createElement("span");
        var liTag = document.createElement("li");
        liTag.dataset.text = prodItem.textContent;
        liTag.textContent = prodItem.textContent + " \u00A0\u00A0";
        liTag.dataset.value = prodItem.value.toString();
        liTag.dataset.percent = allShowList.length === 0 ? "90" : "10";
        liTag.appendChild(iMinusTag);
        liTag.appendChild(spanTag);
        liTag.appendChild(iPlusTag);
        //AddHidden(liTag, index);
        // Action    
        var showList = allShowList.length % 2 === 0 ?
            document.getElementById("evenProductLs") :
            document.getElementById("oddProductLs");
        showList === null || showList === void 0 ? void 0 : showList.appendChild(liTag);
        var allShowList2 = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
        allShowList2.forEach(function (item, index) {
            Array.from(item.getElementsByTagName('input')).forEach(function (subItem) {
                subItem.remove();
            });
            // AddHidden(item as HTMLLIElement, index);
        });
        //Event
        var thisObj = this;
        iMinusTag.addEventListener('click', function () {
            var nowLITag = this.parentElement;
            thisObj.CaculatePercent(nowLITag, false);
            thisObj.RefreshProdItemPercent();
            thisObj.ShowTotalInfo();
            thisObj.SetBindingValue();
            var allShowList3 = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
            allShowList3.forEach(function (item, index) {
                Array.from(item.getElementsByTagName('input')).forEach(function (subItem) {
                    subItem.remove();
                });
                thisObj.AddHidden(item, index);
            });
        });
        iPlusTag.addEventListener('click', function () {
            var nowLITag = this.parentElement;
            thisObj.CaculatePercent(nowLITag, true);
            thisObj.RefreshProdItemPercent();
            thisObj.ShowTotalInfo();
            thisObj.SetBindingValue();
            var allShowList4 = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
            allShowList4.forEach(function (item, index) {
                Array.from(item.getElementsByTagName('input')).forEach(function (subItem) {
                    subItem.remove();
                });
                thisObj.AddHidden(item, index);
            });
        });
    };
    ;
    CreateWeightNotePageClass.prototype.AppendToShowList2 = function (prodItem, showListNum) {
        var allShowList = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
        var iMinusTag = document.createElement("i");
        iMinusTag.classList.add("fas");
        iMinusTag.classList.add("fa-minus-circle");
        iMinusTag.style.cursor = "pointer";
        iMinusTag.style.color = "blue";
        var iPlusTag = document.createElement("i");
        iPlusTag.classList.add("fas");
        iPlusTag.classList.add("fa-plus-circle");
        iPlusTag.style.cursor = "pointer";
        iPlusTag.style.color = "red";
        var spanTag = document.createElement("span");
        var liTag = document.createElement("li");
        liTag.dataset.text = prodItem.text;
        liTag.textContent = prodItem.text + " \u00A0\u00A0";
        liTag.dataset.value = prodItem.value;
        liTag.dataset.percent = showListNum === 0 ? "90" : "10";
        liTag.appendChild(iMinusTag);
        liTag.appendChild(spanTag);
        liTag.appendChild(iPlusTag);
        // Action    
        var showList = showListNum % 2 === 0 ?
            document.getElementById("evenProductLs") :
            document.getElementById("oddProductLs");
        showList === null || showList === void 0 ? void 0 : showList.appendChild(liTag);
    };
    ;
    CreateWeightNotePageClass.prototype.DelProdItemOfShowList = function (prodItemId) {
        var allShowList = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
        allShowList.filter(function (item) { return item.dataset.value === prodItemId; }).forEach(function (item) { return item.remove(); });
    };
    ;
    CreateWeightNotePageClass.prototype.RefreshProdItemPercent = function () {
        var allProdItems = $('#evenProductLs li').toArray().concat($('#oddProductLs li').toArray());
        allProdItems.forEach(function (item) {
            var spanTag = item.querySelector("span");
            spanTag.innerHTML = "\u00A0\u00A0" + item.dataset.percent + "%\u00A0\u00A0";
        });
    };
    CreateWeightNotePageClass.prototype.AddHidden = function (theLi, index) {
        // Create a hidden input element, and append it to the li:
        var nameProperty = document.createElement("input");
        nameProperty.className = "modelbind";
        nameProperty.type = "hidden";
        nameProperty.name = "VE_PurchaseIngredientLs[" + index + "].ItemName";
        nameProperty.value = theLi.dataset.text;
        var valueProperty = document.createElement("input");
        nameProperty.className = "modelbind";
        valueProperty.type = "hidden";
        valueProperty.name = "VE_PurchaseIngredientLs[" + index + "].ProductId";
        valueProperty.value = theLi.dataset.value;
        var percentProperty = document.createElement("input");
        nameProperty.className = "modelbind";
        percentProperty.type = "hidden";
        percentProperty.name = "VE_PurchaseIngredientLs[" + index + "].ItemPercent";
        percentProperty.value = theLi.dataset.percent;
        theLi.appendChild(nameProperty);
        theLi.appendChild(valueProperty);
        theLi.appendChild(percentProperty);
    };
    CreateWeightNotePageClass.prototype.ShowTotalInfo = function () {
        var _a;
        var allProdItems = $('#evenProductLs li').toArray().concat($('#oddProductLs li').toArray());
        var allPercent = 0;
        var maxItem;
        allProdItems.forEach(function (item) {
            allPercent = +item.dataset.percent + allPercent;
            if (!maxItem) {
                maxItem = item;
            }
            else {
                maxItem = +maxItem.dataset.percent > +item.dataset.percent ? maxItem : item;
            }
        });
        var totalInfo = document.getElementById("total");
        totalInfo.querySelectorAll("span").forEach(function (item) { item.remove(); });
        var itemSpan = document.createElement("span");
        itemSpan.innerHTML = "\uFF0C\u5DF2\u9078" + allProdItems.length + "\u9805";
        var percentSpan = document.createElement("span");
        percentSpan.innerHTML = "\uFF0C\u6BD4\u4F8B\u52A0\u7E3D:" + allPercent + "%";
        if (allPercent > 100)
            percentSpan.style.color = "red";
        var recognitionSpan = document.createElement("span");
        //let haha = document.querySelector('.select2bs4 :checked') as HTMLOptionElement;
        //alert(haha.value);
        //let recognitionText = ($('.select2bs4').find(':selected').toArray() as HTMLSelectElement[])
        //    .filter(item => { return item.value === maxItem.dataset.value; })[0]?.textContent ?? "無";
        recognitionSpan.innerHTML = "\u8A8D\u5217\u9805\u76EE : " + ((_a = maxItem === null || maxItem === void 0 ? void 0 : maxItem.dataset.text) !== null && _a !== void 0 ? _a : "無");
        totalInfo.appendChild(recognitionSpan);
        totalInfo.appendChild(itemSpan);
        totalInfo.appendChild(percentSpan);
        if (allProdItems.length > 0)
            $('#IsPassPurchase').val("true");
        else
            $('#IsPassPurchase').val("false");
    };
    CreateWeightNotePageClass.prototype.SetBindingValue = function () {
        var allProdItems = $('#evenProductLs li').toArray().concat($('#oddProductLs li').toArray());
        var purchaseDetailInfos = [];
        allProdItems.forEach(function (item) {
            var purchaseDetailInfo = new PurchaseDetailInfo2();
            purchaseDetailInfo.Value = item.dataset.value;
            purchaseDetailInfo.Name = item.textContent;
            purchaseDetailInfo.Percent = parseInt(item.dataset.percent, 10);
            purchaseDetailInfos.push(purchaseDetailInfo);
        });
        if (purchaseDetailInfos.length === 0)
            $('#SelectPurchaseDetailInfos').val(null);
        else {
            $('#SelectPurchaseDetailInfos').val(JSON.stringify(purchaseDetailInfos));
        }
    };
    CreateWeightNotePageClass.prototype.CaculatePercent = function (curProdItem, isPlus) {
        var curVal = curProdItem.dataset.percent;
        var newVal = isPlus ? +curVal + 10 : +curVal - 10;
        if (newVal > 100)
            newVal = 100;
        if (newVal < 0)
            newVal = 0;
        curProdItem.dataset.percent = newVal.toString();
        //var el = document.getElementById("outside");
        //el.addEventListener("click", modifyText, false);
    };
    return CreateWeightNotePageClass;
}());
;
var PurchaseDetailInfo2 = /** @class */ (function () {
    function PurchaseDetailInfo2() {
    }
    return PurchaseDetailInfo2;
}());
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3JlYXRlV2VpZ2h0Tm90ZV9PbGQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zY3JpcHRzL0NyZWF0ZVdlaWdodE5vdGVfT2xkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBU0ksbUNBQVksT0FBb0I7UUFBcEIsd0JBQUEsRUFBQSxZQUFvQjtRQUM1QixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztJQUMzQixDQUFDO0lBR00sZ0RBQVksR0FBbkI7UUFDSSxhQUFhO1FBQ2IsSUFBSSxVQUFVLEdBQUcsQ0FBQyxDQUFDLHVDQUF1QyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25FLElBQUksZUFBZSxHQUFHLENBQUMsQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN6RSxJQUFJLFNBQVMsR0FBRyxDQUFDLENBQUMsa0NBQWtDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0QsSUFBSSxlQUFlLEdBQUcsQ0FBQyxDQUFDLHdDQUF3QyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3pFLElBQUksU0FBUyxHQUFHLENBQUMsQ0FBQyx1Q0FBdUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRSxJQUFJLFlBQVksR0FBRyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7UUFFekMsZ0JBQWdCO1FBQ2hCLDREQUE0RDtRQUM1RCxpRUFBaUU7UUFDakUsMkRBQTJEO1FBQzNELGlFQUFpRTtRQUNqRSwyREFBMkQ7UUFDM0QsdUZBQXVGO0lBQzNGLENBQUM7SUFBQSxDQUFDO0lBRUssbURBQWUsR0FBdEIsVUFBdUIsVUFBK0IsRUFBRSxTQUFTO1FBQzdELFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBRSxPQUFPO1FBQzdCLElBQUksYUFBYSxH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QUMsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUN6QztZQUNELENBQUMsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQztTQUM1RTtJQUVMLENBQUM7SUFFTSxtREFBZSxHQUF0QixVQUF1QixXQUEwQixFQUFFLE1BQWU7UUFDOUQsSUFBTSxNQUFNLEdBQUcsV0FBVyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDM0MsSUFBSSxNQUFNLEdBQVcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQztRQUMxRCxJQUFJLE1BQU0sR0FBRyxHQUFHO1lBQ1osTUFBTSxHQUFHLEdBQUcsQ0FBQztRQUNqQixJQUFJLE1BQU0sR0FBRyxDQUFDO1lBQ1YsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUNmLFdBQVcsQ0FBQyxPQUFPLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNoRCw4Q0FBOEM7UUFDOUMsa0RBQWtEO0lBQ3RELENBQUM7SUFDTCxnQ0FBQztBQUFELENBQUMsQUF4VUQsSUF3VUM7QUFBQSxDQUFDO0FBRUY7SUFLSTtJQUNBLENBQUM7SUFDTCwwQkFBQztBQUFELENBQUMsQUFQRCxJQU9DIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQ3JlYXRlV2VpZ2h0Tm90ZVBhZ2VDbGFzcyB7XHJcbiAgICAvLyBHbG9iYWxcclxuXHJcbiAgICAvLyBSZWFkeSBQb3N0XHJcblxyXG5cclxuXHJcblxyXG4gICAgQmFzZVVybDogc3RyaW5nO1xyXG4gICAgY29uc3RydWN0b3IoYmFzZVVybDogc3RyaW5nID0gXCJcIikge1xyXG4gICAgICAgIHRoaXMuQmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyBJbmlQYWdlRXZlbnQoKSB7XHJcbiAgICAgICAgLy8gUGFnZSBGaWVsZFxyXG4gICAgICAgIGxldCBmdWxsV2VpZ2h0ID0gJCgnI1ZFX1B1cmNoYXNlV2VpZ2h0Tm90ZV9GdWxsV2VpZ2h0VGltZScpLmdldCgwKTtcclxuICAgICAgICBsZXQgZGVmZWN0aXZlV2VpZ2h0ID0gJCgnI1ZFX1B1cmNoYXNlV2VpZ2h0Tm90ZV9EZWZlY3RpdmVXZWlnaHQnKS5nZXQoMCk7XHJcbiAgICAgICAgbGV0IHVuaXRQcmljZSA9ICQoJyNWRV9QdXJjaGFzZVdlaWdodE5vdGVfVW5pdFByaWNlJykuZ2V0KDApO1xyXG4gICAgICAgIGxldCB0cmFmaWNVbml0UHJpY2UgPSAkKCcjVkVfUHVyY2hhc2VXZWlnaHROb3RlX1RyYWZpY1VuaXRQcmljZScpLmdldCgwKTtcclxuICAgICAgICBsZXQgd2VpZ2h0RmVlID0gJCgnI1ZFX1B1cmNoYXNlV2VpZ2h0Tm90ZV9UaGlyZFdlaWdodEZlZScpLmdldCgwKTtcclxuICAgICAgICBsZXQgaXNoYXNUYXhMaXN0ID0gJChcIi5pc2hhc190YXhcIikuZ2V0KCk7XHJcblxyXG4gICAgICAgIC8vIExvZ2ljICAgICAgICBcclxuICAgICAgICAvL2Z1bGxXZWlnaHQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLkNhY3VsYXRlQWxsRmVlKTtcclxuICAgICAgICAvL2RlZmVjdGl2ZVdlaWdodC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuQ2FjdWxhdGVBbGxGZWUpO1xyXG4gICAgICAgIC8vdW5pdFByaWNlLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5DYWN1bGF0ZUFsbEZlZSk7XHJcbiAgICAgICAgLy90cmFmaWNVbml0UHJpY2UuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLkNhY3VsYXRlQWxsRmVlKTtcclxuICAgICAgICAvL3dlaWdodEZlZS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuQ2FjdWxhdGVBbGxGZWUpO1xyXG4gICAgICAgIC8vaXNoYXNUYXhMaXN0LmZvckVhY2goKGl0ZW0pID0+IGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5DYWN1bGF0ZUFsbEZlZSkpO1xyXG4gICAgfTtcclxuXHJcbiAgICBwdWJsaWMgUmVTZXRDYXJOb0l0ZW1zKGNhck5vSWRPYmo6IEpRdWVyeTxIVE1MRWxlbWVudD4sIGRhdGFPYmpMcykge1xyXG4gICAgICAgIGNhck5vSWRPYmouaHRtbCgnJyk7ICAvLyDpgbjpoIXmuIXnqbpcclxuICAgICAgICBsZXQgZGVmYXVsdE9wdGlvbiA9IG5ldyBPcHRpb24oXCIwLuaWsOi7iueJjFwiLCBcIjBcIiwgZmFsc2UsIGZhbHNlKTtcclxuICAgICAgICBjYXJOb0lkT2JqLmFwcGVuZChkZWZhdWx0T3B0aW9uKTtcclxuICAgICAgICBkYXRhT2JqTHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgeyAgLy8g5riF5Zau6aCF55uuXHJcbiAgICAgICAgICAgIGxldCBuZXdPcHRpb24gPSBuZXcgT3B0aW9uKGl0ZW0uY2FyTmFtZSwgaXRlbS5pZCwgZmFsc2UsIGZhbHNlKTtcclxuICAgICAgICAgICAgY2FyTm9JZE9iai5hcHBlbmQobmV3T3B0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHVibGljIFNob3dMaXN0KCkge1xyXG5cclxuICAgICAgICAvLyDlgrPlhaXntZDmnpwg5qC55pOa57WQ5p6c5qqi5p+l5piv5ZCm54K65paw5aKe5LiN54K65paw5aKe55qE5YmHUGFzc++8jOS4jeWGjeS/neeVmea4heWWrueahOWJh+enu+mZpFxyXG5cclxuXHJcbiAgICAgICAgLy9sZXQgdXNlclNlbGVjdCA9ICgkKCcuc2VsZWN0MmJzNCcpLmZpbmQoJzpzZWxlY3RlZCcpLmdldCgpIGFzIEhUTUxTZWxlY3RFbGVtZW50W10pO1xyXG4gICAgICAgIC8vIFVzZXLnlavpnaLmiYDpgbhcclxuICAgICAgICBsZXQgdXNlclNlbGVjdCA9ICQoJy5zZWxlY3QyYnM0JykuZmluZCgnOnNlbGVjdGVkJykudG9BcnJheSgpIGFzIEhUTUxTZWxlY3RFbGVtZW50W107XHJcblxyXG4gICAgICAgIC8vIOa6luWCmeimgVNob3dcclxuICAgICAgICBsZXQgc2hvd0xpc3QgPSAkKCcjZXZlblByb2R1Y3RMcyBsaScpLnRvQXJyYXkoKS5jb25jYXQoJCgnI29kZFByb2R1Y3RMcyBsaScpLnRvQXJyYXkoKSkgYXMgSFRNTExJRWxlbWVudFtdO1xyXG5cclxuXHJcblxyXG4gICAgICAgIC8vIOimgeaWsOWinueahOWwseaWsOWinlxyXG4gICAgICAgIHVzZXJTZWxlY3QuZmlsdGVyKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gc2hvd0xpc3QubWFwKGxpdGFnID0+IGxpdGFnLmRhdGFzZXQudmFsdWUpLmluZGV4T2YoaXRlbS52YWx1ZSkgPT09IC0xO1xyXG4gICAgICAgIH0pLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuQXBwZW5kVG9TaG93TGlzdChpdGVtKSk7XHJcbiAgICAgICAgLy8g6KaB5Yiq6Zmk55qE5bCx5Yiq6ZmkICAgIFxyXG4gICAgICAgIHNob3dMaXN0LmZpbHRlcihsaXRhZyA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB1c2VyU2VsZWN0Lm1hcChpdGVtID0+IGl0ZW0udmFsdWUpLmluZGV4T2YobGl0YWcuZGF0YXNldC52YWx1ZSkgPT09IC0xO1xyXG4gICAgICAgIH0pLmZvckVhY2goaXRlbSA9PiBpdGVtLnJlbW92ZSgpKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHVibGljIFNob3dMaXN0Mih1c2VyU2VsZWN0ZWRWYWxzOiBzdHJpbmdbXSxcclxuICAgICAgICBldmVuUHJvZHVjdExpVGFnTHM6IEhUTUxMSUVsZW1lbnRbXSxcclxuICAgICAgICBvZGRQcm9kdWN0TGlUYWdMczogSFRNTExJRWxlbWVudFtdKSB7XHJcblxyXG4gICAgICAgIC8vIOWCs+WFpee1kOaenCDmoLnmk5rntZDmnpzmqqLmn6XmmK/lkKbngrrmlrDlop7kuI3ngrrmlrDlop7nmoTliYdQYXNz77yM5LiN5YaN5L+d55WZ5riF5Zau55qE5YmH56e76ZmkXHJcblxyXG5cclxuICAgICAgICAvLyBVc2Vy55Wr6Z2i5omA6YG4XHJcbiAgICAgICAgbGV0IHVzZXJTZWxlY3QgPSAkKCcuc2VsZWN0MmJzNCcpLmZpbmQoJzpzZWxlY3RlZCcpLnRvQXJyYXkoKTtcclxuICAgICAgICBsZXQgdXNlclNlbGVjdDIgPSAoJCgnLnNlbGVjdDJiczQnKS5maW5kKCc6c2VsZWN0ZWQnKS50b0FycmF5KCkgYXMgSFRNTE9wdGlvbkVsZW1lbnRbXSlcclxuICAgICAgICAgICAgLm1hcChpdGVtID0+IGl0ZW0udmFsdWUpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIC8vIOW3rumbhlxyXG4gICAgICAgIC8vIOimgeaWsOWinueahOWwseaWsOWinlxyXG4gICAgICAgIC8vdXNlclNlbGVjdC5maWx0ZXIoaXRlbSA9PiB7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuIHNob3dMaXN0Lm1hcChsaXRhZyA9PiBsaXRhZy5kYXRhc2V0LnZhbHVlKS5pbmRleE9mKGl0ZW0udmFsdWUpID09PSAtMTtcclxuICAgICAgICAvL30pLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuQXBwZW5kVG9TaG93TGlzdChpdGVtKSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgY29uc29sZS5sb2codXNlclNlbGVjdDIpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgR2V0U2hvd1Byb2RJdGVtSWRzKGV2ZW5Qcm9kdWN0TGlUYWdzOiBIVE1MTElFbGVtZW50W10sIG9kZFByb2R1Y3RMaVRhZ3M6IEhUTUxMSUVsZW1lbnRbXSk6IHN0cmluZ1tdIHtcclxuICAgICAgICAvLyAkKFwiI29kZFByb2R1Y3RMcyBsaVwiKS50b0FycmF5KClcclxuICAgICAgICBjb25zdCBhbGxTaG93TGlUYWdzID0gZXZlblByb2R1Y3RMaVRhZ3MuY29uY2F0KG9kZFByb2R1Y3RMaVRhZ3MpO1xyXG5cclxuICAgICAgICBpZiAoYWxsU2hvd0xpVGFncylcclxuICAgICAgICAgICAgcmV0dXJuIGFsbFNob3dMaVRhZ3MubWFwKGl0ZW0gPT4geyByZXR1cm4gaXRlbS5kYXRhc2V0LnZhbHVlIH0pXHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyBBcHBlbmRUb1Nob3dMaXN0KHByb2RJdGVtOiBIVE1MU2VsZWN0RWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IGFsbFNob3dMaXN0ID0gJChcIiNldmVuUHJvZHVjdExzIGxpXCIpLnRvQXJyYXkoKS5jb25jYXQoJChcIiNvZGRQcm9kdWN0THMgbGlcIikudG9BcnJheSgpKTtcclxuXHJcblxyXG4gICAgICAgIGNvbnN0IGlNaW51c1RhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpXCIpO1xyXG4gICAgICAgIGlNaW51c1RhZy5jbGFzc0xpc3QuYWRkKFwiZmFzXCIpO1xyXG4gICAgICAgIGlNaW51c1RhZy5jbGFzc0xpc3QuYWRkKFwiZmEtbWludXMtY2lyY2xlXCIpO1xyXG4gICAgICAgIGlNaW51c1RhZy5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcclxuICAgICAgICBpTWludXNUYWcuc3R5bGUuY29sb3IgPSBcImJsdWVcIjtcclxuICAgICAgICBjb25zdCBpUGx1c1RhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpXCIpO1xyXG4gICAgICAgIGlQbHVzVGFnLmNsYXNzTGlzdC5hZGQoXCJmYXNcIik7XHJcbiAgICAgICAgaVBsdXNUYWcuY2xhc3NMaXN0LmFkZChcImZhLXBsdXMtY2lyY2xlXCIpO1xyXG4gICAgICAgIGlQbHVzVGFnLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xyXG4gICAgICAgIGlQbHVzVGFnLnN0eWxlLmNvbG9yID0gXCJyZWRcIjtcclxuICAgICAgICBjb25zdCBzcGFuVGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIikgYXMgSFRNTFNwYW5FbGVtZW50O1xyXG5cclxuXHJcbiAgICAgICAgY29uc3QgbGlUYWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIikgYXMgSFRNTExJRWxlbWVudDtcclxuICAgICAgICBsaVRhZy5kYXRhc2V0LnRleHQgPSBwcm9kSXRlbS50ZXh0Q29udGVudDtcclxuICAgICAgICBsaVRhZy50ZXh0Q29udGVudCA9IGAke3Byb2RJdGVtLnRleHRDb250ZW50fSBcXHUwMEEwXFx1MDBBMGA7XHJcbiAgICAgICAgbGlUYWcuZGF0YXNldC52YWx1ZSA9IHByb2RJdGVtLnZhbHVlLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgbGlUYWcuZGF0YXNldC5wZXJjZW50ID0gYWxsU2hvd0xpc3QubGVuZ3RoID09PSAwID8gXCI5MFwiIDogXCIxMFwiO1xyXG4gICAgICAgIGxpVGFnLmFwcGVuZENoaWxkKGlNaW51c1RhZyk7XHJcbiAgICAgICAgbGlUYWcuYXBwZW5kQ2hpbGQoc3BhblRhZyk7XHJcbiAgICAgICAgbGlUYWcuYXBwZW5kQ2hpbGQoaVBsdXNUYWcpO1xyXG5cclxuXHJcbiAgICAgICAgLy9BZGRIaWRkZW4obGlUYWcsIGluZGV4KTtcclxuXHJcbiAgICAgICAgLy8gQWN0aW9uICAgIFxyXG4gICAgICAgIGNvbnN0IHNob3dMaXN0ID0gYWxsU2hvd0xpc3QubGVuZ3RoICUgMiA9PT0gMCA/XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXZlblByb2R1Y3RMc1wiKSA6XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib2RkUHJvZHVjdExzXCIpO1xyXG4gICAgICAgIHNob3dMaXN0Py5hcHBlbmRDaGlsZChsaVRhZyk7XHJcblxyXG4gICAgICAgIGxldCBhbGxTaG93TGlzdDIgPSAkKFwiI2V2ZW5Qcm9kdWN0THMgbGlcIikudG9BcnJheSgpLmNvbmNhdCgkKFwiI29kZFByb2R1Y3RMcyBsaVwiKS50b0FycmF5KCkpXHJcbiAgICAgICAgYWxsU2hvd0xpc3QyLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIEFycmF5LmZyb20oaXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKSkuZm9yRWFjaChzdWJJdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIHN1Ykl0ZW0ucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gQWRkSGlkZGVuKGl0ZW0gYXMgSFRNTExJRWxlbWVudCwgaW5kZXgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL0V2ZW50XHJcbiAgICAgICAgbGV0IHRoaXNPYmogPSB0aGlzO1xyXG4gICAgICAgIGlNaW51c1RhZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGV0IG5vd0xJVGFnID0gdGhpcy5wYXJlbnRFbGVtZW50IGFzIEhUTUxMSUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHRoaXNPYmouQ2FjdWxhdGVQZXJjZW50KG5vd0xJVGFnLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXNPYmouUmVmcmVzaFByb2RJdGVtUGVyY2VudCgpO1xyXG4gICAgICAgICAgICB0aGlzT2JqLlNob3dUb3RhbEluZm8oKTtcclxuICAgICAgICAgICAgdGhpc09iai5TZXRCaW5kaW5nVmFsdWUoKTtcclxuICAgICAgICAgICAgbGV0IGFsbFNob3dMaXN0MyA9ICQoXCIjZXZlblByb2R1Y3RMcyBsaVwiKS50b0FycmF5KCkuY29uY2F0KCQoXCIjb2RkUHJvZHVjdExzIGxpXCIpLnRvQXJyYXkoKSlcclxuICAgICAgICAgICAgYWxsU2hvd0xpc3QzLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBBcnJheS5mcm9tKGl0ZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lucHV0JykpLmZvckVhY2goc3ViSXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViSXRlbS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXNPYmouQWRkSGlkZGVuKGl0ZW0gYXMgSFRNTExJRWxlbWVudCwgaW5kZXgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaVBsdXNUYWcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGxldCBub3dMSVRhZyA9IHRoaXMucGFyZW50RWxlbWVudCBhcyBIVE1MTElFbGVtZW50XHJcbiAgICAgICAgICAgIHRoaXNPYmouQ2FjdWxhdGVQZXJjZW50KG5vd0xJVGFnLCB0cnVlKTtcclxuICAgICAgICAgICAgdGhpc09iai5SZWZyZXNoUHJvZEl0ZW1QZXJjZW50KCk7XHJcbiAgICAgICAgICAgIHRoaXNPYmouU2hvd1RvdGFsSW5mbygpO1xyXG4gICAgICAgICAgICB0aGlzT2JqLlNldEJpbmRpbmdWYWx1ZSgpO1xyXG4gICAgICAgICAgICBsZXQgYWxsU2hvd0xpc3Q0ID0gJChcIiNldmVuUHJvZHVjdExzIGxpXCIpLnRvQXJyYXkoKS5jb25jYXQoJChcIiNvZGRQcm9kdWN0THMgbGlcIikudG9BcnJheSgpKVxyXG4gICAgICAgICAgICBhbGxTaG93TGlzdDQuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgIEFycmF5LmZyb20oaXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKSkuZm9yRWFjaChzdWJJdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBzdWJJdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpc09iai5BZGRIaWRkZW4oaXRlbSBhcyBIVE1MTElFbGVtZW50LCBpbmRleCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBwdWJsaWMgQXBwZW5kVG9TaG93TGlzdDIocHJvZEl0ZW06IEhUTUxPcHRpb25FbGVtZW50LCBzaG93TGlzdE51bTogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgYWxsU2hvd0xpc3QgPSAkKFwiI2V2ZW5Qcm9kdWN0THMgbGlcIikudG9BcnJheSgpLmNvbmNhdCgkKFwiI29kZFByb2R1Y3RMcyBsaVwiKS50b0FycmF5KCkpO1xyXG5cclxuICAgICAgICBjb25zdCBpTWludXNUYWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaVwiKTtcclxuICAgICAgICBpTWludXNUYWcuY2xhc3NMaXN0LmFkZChcImZhc1wiKTtcclxuICAgICAgICBpTWludXNUYWcuY2xhc3NMaXN0LmFkZChcImZhLW1pbnVzLWNpcmNsZVwiKTtcclxuICAgICAgICBpTWludXNUYWcuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XHJcbiAgICAgICAgaU1pbnVzVGFnLnN0eWxlLmNvbG9yID0gXCJibHVlXCI7XHJcbiAgICAgICAgY29uc3QgaVBsdXNUYWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaVwiKTtcclxuICAgICAgICBpUGx1c1RhZy5jbGFzc0xpc3QuYWRkKFwiZmFzXCIpO1xyXG4gICAgICAgIGlQbHVzVGFnLmNsYXNzTGlzdC5hZGQoXCJmYS1wbHVzLWNpcmNsZVwiKTtcclxuICAgICAgICBpUGx1c1RhZy5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcclxuICAgICAgICBpUGx1c1RhZy5zdHlsZS5jb2xvciA9IFwicmVkXCI7XHJcblxyXG4gICAgICAgIGNvbnN0IHNwYW5UYWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKSBhcyBIVE1MU3BhbkVsZW1lbnQ7XHJcbiAgICAgICAgY29uc3QgbGlUYWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIikgYXMgSFRNTExJRWxlbWVudDtcclxuICAgICAgICBsaVRhZy5kYXRhc2V0LnRleHQgPSBwcm9kSXRlbS50ZXh0O1xyXG4gICAgICAgIGxpVGFnLnRleHRDb250ZW50ID0gYCR7cHJvZEl0ZW0udGV4dH0gXFx1MDBBMFxcdTAwQTBgO1xyXG4gICAgICAgIGxpVGFnLmRhdGFzZXQudmFsdWUgPSBwcm9kSXRlbS52YWx1ZTtcclxuICAgICAgICBsaVRhZy5kYXRhc2V0LnBlcmNlbnQgPSBzaG93TGlzdE51bSA9PT0gMCA/IFwiOTBcIiA6IFwiMTBcIjtcclxuICAgICAgICBsaVRhZy5hcHBlbmRDaGlsZChpTWludXNUYWcpO1xyXG4gICAgICAgIGxpVGFnLmFwcGVuZENoaWxkKHNwYW5UYWcpO1xyXG4gICAgICAgIGxpVGFnLmFwcGVuZENoaWxkKGlQbHVzVGFnKTtcclxuXHJcbiAgICAgICAgLy8gQWN0aW9uICAgIFxyXG4gICAgICAgIGNvbnN0IHNob3dMaXN0ID0gc2hvd0xpc3ROdW0gJSAyID09PSAwID9cclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJldmVuUHJvZHVjdExzXCIpIDpcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvZGRQcm9kdWN0THNcIik7XHJcbiAgICAgICAgc2hvd0xpc3Q/LmFwcGVuZENoaWxkKGxpVGFnKTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHB1YmxpYyBEZWxQcm9kSXRlbU9mU2hvd0xpc3QocHJvZEl0ZW1JZDogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgYWxsU2hvd0xpc3QgPSAkKFwiI2V2ZW5Qcm9kdWN0THMgbGlcIikudG9BcnJheSgpLmNvbmNhdCgkKFwiI29kZFByb2R1Y3RMcyBsaVwiKS50b0FycmF5KCkpIGFzIEhUTUxMSUVsZW1lbnRbXTtcclxuICAgICAgICBhbGxTaG93TGlzdC5maWx0ZXIoaXRlbSA9PiBpdGVtLmRhdGFzZXQudmFsdWUgPT09IHByb2RJdGVtSWQpLmZvckVhY2goaXRlbSA9PiBpdGVtLnJlbW92ZSgpKTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHB1YmxpYyBSZWZyZXNoUHJvZEl0ZW1QZXJjZW50KCkge1xyXG4gICAgICAgIGxldCBhbGxQcm9kSXRlbXMgPSAkKCcjZXZlblByb2R1Y3RMcyBsaScpLnRvQXJyYXkoKS5jb25jYXQoXHJcbiAgICAgICAgICAgICQoJyNvZGRQcm9kdWN0THMgbGknKS50b0FycmF5KCkpIGFzIEhUTUxMSUVsZW1lbnRbXTtcclxuXHJcbiAgICAgICAgYWxsUHJvZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgbGV0IHNwYW5UYWcgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoXCJzcGFuXCIpO1xyXG4gICAgICAgICAgICBzcGFuVGFnLmlubmVySFRNTCA9IGBcXHUwMEEwXFx1MDBBMCR7aXRlbS5kYXRhc2V0LnBlcmNlbnR9JVxcdTAwQTBcXHUwMEEwYFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBBZGRIaWRkZW4odGhlTGk6IEhUTUxMSUVsZW1lbnQsIGluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICAvLyBDcmVhdGUgYSBoaWRkZW4gaW5wdXQgZWxlbWVudCwgYW5kIGFwcGVuZCBpdCB0byB0aGUgbGk6XHJcbiAgICAgICAgbGV0IG5hbWVQcm9wZXJ0eSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICAgICAgICBuYW1lUHJvcGVydHkuY2xhc3NOYW1lID0gXCJtb2RlbGJpbmRcIlxyXG4gICAgICAgIG5hbWVQcm9wZXJ0eS50eXBlID0gXCJoaWRkZW5cIjtcclxuICAgICAgICBuYW1lUHJvcGVydHkubmFtZSA9IGBWRV9QdXJjaGFzZUluZ3JlZGllbnRMc1ske2luZGV4fV0uSXRlbU5hbWVgO1xyXG4gICAgICAgIG5hbWVQcm9wZXJ0eS52YWx1ZSA9IHRoZUxpLmRhdGFzZXQudGV4dFxyXG4gICAgICAgIGxldCB2YWx1ZVByb3BlcnR5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgIG5hbWVQcm9wZXJ0eS5jbGFzc05hbWUgPSBcIm1vZGVsYmluZFwiXHJcbiAgICAgICAgdmFsdWVQcm9wZXJ0eS50eXBlID0gXCJoaWRkZW5cIjtcclxuICAgICAgICB2YWx1ZVByb3BlcnR5Lm5hbWUgPSBgVkVfUHVyY2hhc2VJbmdyZWRpZW50THNbJHtpbmRleH1dLlByb2R1Y3RJZGA7XHJcbiAgICAgICAgdmFsdWVQcm9wZXJ0eS52YWx1ZSA9IHRoZUxpLmRhdGFzZXQudmFsdWVcclxuICAgICAgICBsZXQgcGVyY2VudFByb3BlcnR5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgIG5hbWVQcm9wZXJ0eS5jbGFzc05hbWUgPSBcIm1vZGVsYmluZFwiXHJcbiAgICAgICAgcGVyY2VudFByb3BlcnR5LnR5cGUgPSBcImhpZGRlblwiO1xyXG4gICAgICAgIHBlcmNlbnRQcm9wZXJ0eS5uYW1lID0gYFZFX1B1cmNoYXNlSW5ncmVkaWVudExzWyR7aW5kZXh9XS5JdGVtUGVyY2VudGA7XHJcbiAgICAgICAgcGVyY2VudFByb3BlcnR5LnZhbHVlID0gdGhlTGkuZGF0YXNldC5wZXJjZW50XHJcblxyXG4gICAgICAgIHRoZUxpLmFwcGVuZENoaWxkKG5hbWVQcm9wZXJ0eSk7XHJcbiAgICAgICAgdGhlTGkuYXBwZW5kQ2hpbGQodmFsdWVQcm9wZXJ0eSk7XHJcbiAgICAgICAgdGhlTGkuYXBwZW5kQ2hpbGQocGVyY2VudFByb3BlcnR5KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgU2hvd1RvdGFsSW5mbygpIHtcclxuICAgICAgICBsZXQgYWxsUHJvZEl0ZW1zID0gJCgnI2V2ZW5Qcm9kdWN0THMgbGknKS50b0FycmF5KCkuY29uY2F0KFxyXG4gICAgICAgICAgICAkKCcjb2RkUHJvZHVjdExzIGxpJykudG9BcnJheSgpKSBhcyBIVE1MTElFbGVtZW50W107XHJcblxyXG4gICAgICAgIGxldCBhbGxQZXJjZW50ID0gMDtcclxuICAgICAgICBsZXQgbWF4SXRlbTogSFRNTExJRWxlbWVudDtcclxuICAgICAgICBhbGxQcm9kSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICBhbGxQZXJjZW50ID0gKyBpdGVtLmRhdGFzZXQucGVyY2VudCArIGFsbFBlcmNlbnQ7XHJcbiAgICAgICAgICAgIGlmICghbWF4SXRlbSkge1xyXG4gICAgICAgICAgICAgICAgbWF4SXRlbSA9IGl0ZW07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBtYXhJdGVtID0gK21heEl0ZW0uZGF0YXNldC5wZXJjZW50ID4gK2l0ZW0uZGF0YXNldC5wZXJjZW50ID8gbWF4SXRlbSA6IGl0ZW07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgdG90YWxJbmZvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b3RhbFwiKTtcclxuICAgICAgICB0b3RhbEluZm8ucXVlcnlTZWxlY3RvckFsbChcInNwYW5cIikuZm9yRWFjaChpdGVtID0+IHsgaXRlbS5yZW1vdmUoKSB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgaXRlbVNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcclxuICAgICAgICBpdGVtU3Bhbi5pbm5lckhUTUwgPSBg77yM5bey6YG4JHthbGxQcm9kSXRlbXMubGVuZ3RofemghWA7XHJcbiAgICAgICAgY29uc3QgcGVyY2VudFNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcclxuICAgICAgICBwZXJjZW50U3Bhbi5pbm5lckhUTUwgPSBg77yM5q+U5L6L5Yqg57i9OiR7YWxsUGVyY2VudH0lYFxyXG4gICAgICAgIGlmIChhbGxQZXJjZW50ID4gMTAwKVxyXG4gICAgICAgICAgICBwZXJjZW50U3Bhbi5zdHlsZS5jb2xvciA9IFwicmVkXCI7XHJcbiAgICAgICAgY29uc3QgcmVjb2duaXRpb25TcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XHJcblxyXG4gICAgICAgIC8vbGV0IGhhaGEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VsZWN0MmJzNCA6Y2hlY2tlZCcpIGFzIEhUTUxPcHRpb25FbGVtZW50O1xyXG4gICAgICAgIC8vYWxlcnQoaGFoYS52YWx1ZSk7XHJcblxyXG4gICAgICAgIC8vbGV0IHJlY29nbml0aW9uVGV4dCA9ICgkKCcuc2VsZWN0MmJzNCcpLmZpbmQoJzpzZWxlY3RlZCcpLnRvQXJyYXkoKSBhcyBIVE1MU2VsZWN0RWxlbWVudFtdKVxyXG4gICAgICAgIC8vICAgIC5maWx0ZXIoaXRlbSA9PiB7IHJldHVybiBpdGVtLnZhbHVlID09PSBtYXhJdGVtLmRhdGFzZXQudmFsdWU7IH0pWzBdPy50ZXh0Q29udGVudCA/PyBcIueEoVwiO1xyXG4gICAgICAgIHJlY29nbml0aW9uU3Bhbi5pbm5lckhUTUwgPSBg6KqN5YiX6aCF55uuIDogJHttYXhJdGVtPy5kYXRhc2V0LnRleHQgPz8gXCLnhKFcIn1gXHJcblxyXG4gICAgICAgIHRvdGFsSW5mby5hcHBlbmRDaGlsZChyZWNvZ25pdGlvblNwYW4pO1xyXG4gICAgICAgIHRvdGFsSW5mby5hcHBlbmRDaGlsZChpdGVtU3Bhbik7XHJcbiAgICAgICAgdG90YWxJbmZvLmFwcGVuZENoaWxkKHBlcmNlbnRTcGFuKTtcclxuXHJcbiAgICAgICAgaWYgKGFsbFByb2RJdGVtcy5sZW5ndGggPiAwKVxyXG4gICAgICAgICAgICAkKCcjSXNQYXNzUHVyY2hhc2UnKS52YWwoXCJ0cnVlXCIpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgJCgnI0lzUGFzc1B1cmNoYXNlJykudmFsKFwiZmFsc2VcIik7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFNldEJpbmRpbmdWYWx1ZSgpIHtcclxuXHJcbiAgICAgICAgbGV0IGFsbFByb2RJdGVtcyA9ICQoJyNldmVuUHJvZHVjdExzIGxpJykudG9BcnJheSgpLmNvbmNhdChcclxuICAgICAgICAgICAgJCgnI29kZFByb2R1Y3RMcyBsaScpLnRvQXJyYXkoKSkgYXMgSFRNTExJRWxlbWVudFtdO1xyXG5cclxuICAgICAgICBsZXQgcHVyY2hhc2VEZXRhaWxJbmZvczogUHVyY2hhc2VEZXRhaWxJbmZvMltdID0gW107XHJcbiAgICAgICAgYWxsUHJvZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgbGV0IHB1cmNoYXNlRGV0YWlsSW5mbyA9IG5ldyBQdXJjaGFzZURldGFpbEluZm8yKCk7XHJcbiAgICAgICAgICAgIHB1cmNoYXNlRGV0YWlsSW5mby5WYWx1ZSA9IGl0ZW0uZGF0YXNldC52YWx1ZTtcclxuICAgICAgICAgICAgcHVyY2hhc2VEZXRhaWxJbmZvLk5hbWUgPSBpdGVtLnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICBwdXJjaGFzZURldGFpbEluZm8uUGVyY2VudCA9IHBhcnNlSW50KGl0ZW0uZGF0YXNldC5wZXJjZW50LCAxMCk7XHJcbiAgICAgICAgICAgIHB1cmNoYXNlRGV0YWlsSW5mb3MucHVzaChwdXJjaGFzZURldGFpbEluZm8pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChwdXJjaGFzZURldGFpbEluZm9zLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgJCgnI1NlbGVjdFB1cmNoYXNlRGV0YWlsSW5mb3MnKS52YWwobnVsbCk7XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICQoJyNTZWxlY3RQdXJjaGFzZURldGFpbEluZm9zJykudmFsKEpTT04uc3RyaW5naWZ5KHB1cmNoYXNlRGV0YWlsSW5mb3MpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBDYWN1bGF0ZVBlcmNlbnQoY3VyUHJvZEl0ZW06IEhUTUxMSUVsZW1lbnQsIGlzUGx1czogYm9vbGVhbikge1xyXG4gICAgICAgIGNvbnN0IGN1clZhbCA9IGN1clByb2RJdGVtLmRhdGFzZXQucGVyY2VudDtcclxuICAgICAgICBsZXQgbmV3VmFsOiBudW1iZXIgPSBpc1BsdXMgPyArY3VyVmFsICsgMTAgOiArY3VyVmFsIC0gMTA7XHJcbiAgICAgICAgaWYgKG5ld1ZhbCA+IDEwMClcclxuICAgICAgICAgICAgbmV3VmFsID0gMTAwO1xyXG4gICAgICAgIGlmIChuZXdWYWwgPCAwKVxyXG4gICAgICAgICAgICBuZXdWYWwgPSAwO1xyXG4gICAgICAgIGN1clByb2RJdGVtLmRhdGFzZXQucGVyY2VudCA9IG5ld1ZhbC50b1N0cmluZygpO1xyXG4gICAgICAgIC8vdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvdXRzaWRlXCIpO1xyXG4gICAgICAgIC8vZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG1vZGlmeVRleHQsIGZhbHNlKTtcclxuICAgIH1cclxufTtcclxuXHJcbmNsYXNzIFB1cmNoYXNlRGV0YWlsSW5mbzIge1xyXG4gICAgVmFsdWU6IHN0cmluZztcclxuICAgIE5hbWU6IHN0cmluZztcclxuICAgIFBlcmNlbnQ6IG51bWJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iXX0=