var CreateWeightNotePageClass = /** @class */ (function () {
    function CreateWeightNotePageClass(baseUrl) {
        if (baseUrl === void 0) { baseUrl = ""; }
        this.BaseUrl = baseUrl;
    }
    CreateWeightNotePageClass.prototype.IniPageEvent = function () {
        // Page Field
        var fullWeight = $('#VE_PurchaseWeightNote_FullWeightTime').get(0);
        var defectiveWeight = $('#VE_PurchaseWeightNote_DefectiveWeight').get(0);
        var unitPrice = $('#VE_PurchaseWeightNote_UnitPrice').get(0);
        var traficUnitPrice = $('#VE_PurchaseWeightNote_TraficUnitPrice').get(0);
        var weightFee = $('#VE_PurchaseWeightNote_ThirdWeightFee').get(0);
        var ishasTaxList = $(".ishas_tax").get();
        // Logic        
        //fullWeight.addEventListener('keyup', this.CaculateAllFee);
        //defectiveWeight.addEventListener('keyup', this.CaculateAllFee);
        //unitPrice.addEventListener('keyup', this.CaculateAllFee);
        //traficUnitPrice.addEventListener('keyup', this.CaculateAllFee);
        //weightFee.addEventListener('keyup', this.CaculateAllFee);
        //ishasTaxList.forEach((item) => item.addEventListener('change', this.CaculateAllFee));
    };
    ;
    CreateWeightNotePageClass.prototype.ReSetCarNoItems = function (carNoIdObj, dataObjLs) {
        carNoIdObj.html(''); // 選項清空
        var defaultOption = new Option("0.新車牌", "0", false, false);
        carNoIdObj.append(defaultOption);
        dataObjLs.forEach(function (item) {
            var newOption = new Option(item.carName, item.id, false, false);
            carNoIdObj.append(newOption);
        });
    };
    CreateWeightNotePageClass.prototype.ShowList = function () {
        // 傳入結果 根據結果檢查是否為新增不為新增的則Pass，不再保留清單的則移除
        var _this = this;
        //let userSelect = ($('.select2bs4').find(':selected').get() as HTMLSelectElement[]);
        // User畫面所選
        var userSelect = $('.select2bs4').find(':selected').toArray();
        // 準備要Show
        var showList = $('#evenProductLs li').toArray().concat($('#oddProductLs li').toArray());
        // 要新增的就新增
        userSelect.filter(function (item) {
            return showList.map(function (litag) { return litag.dataset.value; }).indexOf(item.value) === -1;
        }).forEach(function (item) { return _this.AppendToShowList(item); });
        // 要刪除的就刪除    
        showList.filter(function (litag) {
            return userSelect.map(function (item) { return item.value; }).indexOf(litag.dataset.value) === -1;
        }).forEach(function (item) { return item.remove(); });
    };
    CreateWeightNotePageClass.prototype.ShowList2 = function (userSelectedVals, evenProductLiTagLs, oddProductLiTagLs) {
        // 傳入結果 根據結果檢查是否為新增不為新增的則Pass，不再保留清單的則移除
        // User畫面所選
        var userSelect = $('.select2bs4').find(':selected').toArray();
        var userSelect2 = $('.select2bs4').find(':selected').toArray()
            .map(function (item) { return item.value; });
        // 差集
        // 要新增的就新增
        //userSelect.filter(item => {
        //    return showList.map(litag => litag.dataset.value).indexOf(item.value) === -1;
        //}).forEach((item) => this.AppendToShowList(item));
        console.log(userSelect2);
    };
    CreateWeightNotePageClass.prototype.GetShowProdItemIds = function (testPostObj) {
        var allShowList = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
        if (allShowList) {
            //let abc3 = allShowList.filter((item, index) => {
            //    valueProperty.value = theLi.
            //    return item.name.includes("ProductId");
            //}).map(item => item.value);
            var abc3 = allShowList.map(function (item) { return item.dataset.value; });
            return abc3;
        }
        //let shoList = testPostObj.find('input').toArray();
        //if (shoList) {
        //    let abc2 = shoList.filter((item, index) => {
        //        return item.name.includes("ProductId");
        //    }).map(item => item.value);
        //    //let abc = shoList.map((item, index) => {
        //    //    return (item.name.querySelector(`input[name="VE_PurchaseIngredientLs[${index}].ProductId"`) as HTMLInputElement).value;
        //    //})
        //    return abc2;
        //}
    };
    CreateWeightNotePageClass.prototype.AppendToShowList = function (prodItem) {
        var allShowList = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
        var iMinusTag = document.createElement("i");
        iMinusTag.classList.add("fas");
        iMinusTag.classList.add("fa-minus-circle");
        iMinusTag.style.cursor = "pointer";
        iMinusTag.style.color = "blue";
        var iPlusTag = document.createElement("i");
        iPlusTag.classList.add("fas");
        iPlusTag.classList.add("fa-plus-circle");
        iPlusTag.style.cursor = "pointer";
        iPlusTag.style.color = "red";
        var spanTag = document.createElement("span");
        var liTag = document.createElement("li");
        liTag.dataset.text = prodItem.textContent;
        liTag.textContent = prodItem.textContent + " \u00A0\u00A0";
        liTag.dataset.value = prodItem.value.toString();
        liTag.dataset.percent = allShowList.length === 0 ? "90" : "10";
        liTag.appendChild(iMinusTag);
        liTag.appendChild(spanTag);
        liTag.appendChild(iPlusTag);
        //AddHidden(liTag, index);
        // Action    
        var showList = allShowList.length % 2 === 0 ?
            document.getElementById("evenProductLs") :
            document.getElementById("oddProductLs");
        showList === null || showList === void 0 ? void 0 : showList.appendChild(liTag);
        var allShowList2 = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
        allShowList2.forEach(function (item, index) {
            Array.from(item.getElementsByTagName('input')).forEach(function (subItem) {
                subItem.remove();
            });
            // AddHidden(item as HTMLLIElement, index);
        });
        //Event
        var thisObj = this;
        iMinusTag.addEventListener('click', function () {
            var nowLITag = this.parentElement;
            thisObj.CaculatePercent(nowLITag, false);
            thisObj.RefreshProdItemPercent();
            thisObj.ShowTotalInfo();
            thisObj.SetBindingValue();
            var allShowList3 = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
            allShowList3.forEach(function (item, index) {
                Array.from(item.getElementsByTagName('input')).forEach(function (subItem) {
                    subItem.remove();
                });
                thisObj.AddHidden(item, index);
            });
        });
        iPlusTag.addEventListener('click', function () {
            var nowLITag = this.parentElement;
            thisObj.CaculatePercent(nowLITag, true);
            thisObj.RefreshProdItemPercent();
            thisObj.ShowTotalInfo();
            thisObj.SetBindingValue();
            var allShowList4 = $("#evenProductLs li").toArray().concat($("#oddProductLs li").toArray());
            allShowList4.forEach(function (item, index) {
                Array.from(item.getElementsByTagName('input')).forEach(function (subItem) {
                    subItem.remove();
                });
                thisObj.AddHidden(item, index);
            });
        });
    };
    ;
    CreateWeightNotePageClass.prototype.AppendToShowList2 = function (prodItem) {
    };
    ;
    CreateWeightNotePageClass.prototype.RefreshProdItemPercent = function () {
        var allProdItems = $('#evenProductLs li').toArray().concat($('#oddProductLs li').toArray());
        allProdItems.forEach(function (item) {
            var spanTag = item.querySelector("span");
            spanTag.innerHTML = "\u00A0\u00A0" + item.dataset.percent + "%\u00A0\u00A0";
        });
    };
    CreateWeightNotePageClass.prototype.AddHidden = function (theLi, index) {
        // Create a hidden input element, and append it to the li:
        var nameProperty = document.createElement("input");
        nameProperty.className = "modelbind";
        nameProperty.type = "hidden";
        nameProperty.name = "VE_PurchaseIngredientLs[" + index + "].ItemName";
        nameProperty.value = theLi.dataset.text;
        var valueProperty = document.createElement("input");
        nameProperty.className = "modelbind";
        valueProperty.type = "hidden";
        valueProperty.name = "VE_PurchaseIngredientLs[" + index + "].ProductId";
        valueProperty.value = theLi.dataset.value;
        var percentProperty = document.createElement("input");
        nameProperty.className = "modelbind";
        percentProperty.type = "hidden";
        percentProperty.name = "VE_PurchaseIngredientLs[" + index + "].ItemPercent";
        percentProperty.value = theLi.dataset.percent;
        theLi.appendChild(nameProperty);
        theLi.appendChild(valueProperty);
        theLi.appendChild(percentProperty);
    };
    CreateWeightNotePageClass.prototype.ShowTotalInfo = function () {
        var _a;
        var allProdItems = $('#evenProductLs li').toArray().concat($('#oddProductLs li').toArray());
        var allPercent = 0;
        var maxItem;
        allProdItems.forEach(function (item) {
            allPercent = +item.dataset.percent + allPercent;
            if (!maxItem) {
                maxItem = item;
            }
            else {
                maxItem = +maxItem.dataset.percent > +item.dataset.percent ? maxItem : item;
            }
        });
        var totalInfo = document.getElementById("total");
        totalInfo.querySelectorAll("span").forEach(function (item) { item.remove(); });
        var itemSpan = document.createElement("span");
        itemSpan.innerHTML = "\uFF0C\u5DF2\u9078" + allProdItems.length + "\u9805";
        var percentSpan = document.createElement("span");
        percentSpan.innerHTML = "\uFF0C\u6BD4\u4F8B\u52A0\u7E3D:" + allPercent + "%";
        if (allPercent > 100)
            percentSpan.style.color = "red";
        var recognitionSpan = document.createElement("span");
        //let haha = document.querySelector('.select2bs4 :checked') as HTMLOptionElement;
        //alert(haha.value);
        //let recognitionText = ($('.select2bs4').find(':selected').toArray() as HTMLSelectElement[])
        //    .filter(item => { return item.value === maxItem.dataset.value; })[0]?.textContent ?? "無";
        recognitionSpan.innerHTML = "\u8A8D\u5217\u9805\u76EE : " + ((_a = maxItem === null || maxItem === void 0 ? void 0 : maxItem.dataset.text) !== null && _a !== void 0 ? _a : "無");
        totalInfo.appendChild(recognitionSpan);
        totalInfo.appendChild(itemSpan);
        totalInfo.appendChild(percentSpan);
        if (allProdItems.length > 0)
            $('#IsPassPurchase').val("true");
        else
            $('#IsPassPurchase').val("false");
    };
    CreateWeightNotePageClass.prototype.SetBindingValue = function () {
        var allProdItems = $('#evenProductLs li').toArray().concat($('#oddProductLs li').toArray());
        var purchaseDetailInfos = [];
        allProdItems.forEach(function (item) {
            var purchaseDetailInfo = new PurchaseDetailInfo2();
            purchaseDetailInfo.Value = item.dataset.value;
            purchaseDetailInfo.Name = item.textContent;
            purchaseDetailInfo.Percent = parseInt(item.dataset.percent, 10);
            purchaseDetailInfos.push(purchaseDetailInfo);
        });
        if (purchaseDetailInfos.length === 0)
            $('#SelectPurchaseDetailInfos').val(null);
        else {
            $('#SelectPurchaseDetailInfos').val(JSON.stringify(purchaseDetailInfos));
        }
    };
    CreateWeightNotePageClass.prototype.CaculatePercent = function (curProdItem, isPlus) {
        var curVal = curProdItem.dataset.percent;
        var newVal = isPlus ? +curVal + 10 : +curVal - 10;
        if (newVal > 100)
            newVal = 100;
        if (newVal < 0)
            newVal = 0;
        curProdItem.dataset.percent = newVal.toString();
        //var el = document.getElementById("outside");
        //el.addEventListener("click", modifyText, false);
    };
    return CreateWeightNotePageClass;
}());
;
var PurchaseDetailInfo2 = /** @class */ (function () {
    function PurchaseDetailInfo2() {
    }
    return PurchaseDetailInfo2;
}());
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3JlYXRlV2VpZ2h0Tm90ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NjcmlwdHMvQ3JlYXRlV2VpZ2h0Tm90ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQVNJLG1DQUFZLE9BQW9CO1FBQXBCLHdCQUFBLEVBQUEsWUFBb0I7UUFDNUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7SUFDM0IsQ0FBQztJQUdNLGdEQUFZLEdBQW5CO1FBQ0ksYUFBYTtRQUNiLElBQUksVUFBVSxHQUFHLENBQUMsQ0FBQyx1Q0FBdUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuRSxJQUFJLGVBQWUsR0FBRyxDQUFDLENBQUMsd0NBQXdDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekUsSUFBSSxTQUFTLEdBQUcsQ0FBQyxDQUFDLGtDQUFrQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdELElBQUksZUFBZSxHQUFHLENBQUMsQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN6RSxJQUFJLFNBQVMsR0FBRyxDQUFDLENBQUMsdUNBQXVDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEUsSUFBSSxZQUFZLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBRXpDLGdCQUFnQjtRQUNoQiw0REFBNEQ7UUFDNUQsaUVBQWlFO1FBQ2pFLDJEQUEyRDtRQUMzRCxpRUFBaUU7UUFDakUsMkRBQTJEO1FBQzNELHVGQUF1RjtJQUMzRixDQUFDO0lBQUEsQ0FBQztJQUVLLG1EQUFlLEdBQXRCLFVBQXVCLFVBQStCLEVBQUUsU0FBUztRQUM3RCxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUUsT0FBTztRQUM3QixJQUFJLGFBQWEsR0FBRyxJQUFJ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Q0wsZ0NBQUM7QUFBRCxDQUFDLEFBN1RELElBNlRDO0FBQUEsQ0FBQztBQUVGO0lBS0k7SUFDQSxDQUFDO0lBQ0wsMEJBQUM7QUFBRCxDQUFDLEFBUEQsSUFPQyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIENyZWF0ZVdlaWdodE5vdGVQYWdlQ2xhc3Mge1xyXG4gICAgLy8gR2xvYmFsXHJcblxyXG4gICAgLy8gUmVhZHkgUG9zdFxyXG5cclxuXHJcblxyXG5cclxuICAgIEJhc2VVcmw6IHN0cmluZztcclxuICAgIGNvbnN0cnVjdG9yKGJhc2VVcmw6IHN0cmluZyA9IFwiXCIpIHtcclxuICAgICAgICB0aGlzLkJhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwdWJsaWMgSW5pUGFnZUV2ZW50KCkge1xyXG4gICAgICAgIC8vIFBhZ2UgRmllbGRcclxuICAgICAgICBsZXQgZnVsbFdlaWdodCA9ICQoJyNWRV9QdXJjaGFzZVdlaWdodE5vdGVfRnVsbFdlaWdodFRpbWUnKS5nZXQoMCk7XHJcbiAgICAgICAgbGV0IGRlZmVjdGl2ZVdlaWdodCA9ICQoJyNWRV9QdXJjaGFzZVdlaWdodE5vdGVfRGVmZWN0aXZlV2VpZ2h0JykuZ2V0KDApO1xyXG4gICAgICAgIGxldCB1bml0UHJpY2UgPSAkKCcjVkVfUHVyY2hhc2VXZWlnaHROb3RlX1VuaXRQcmljZScpLmdldCgwKTtcclxuICAgICAgICBsZXQgdHJhZmljVW5pdFByaWNlID0gJCgnI1ZFX1B1cmNoYXNlV2VpZ2h0Tm90ZV9UcmFmaWNVbml0UHJpY2UnKS5nZXQoMCk7XHJcbiAgICAgICAgbGV0IHdlaWdodEZlZSA9ICQoJyNWRV9QdXJjaGFzZVdlaWdodE5vdGVfVGhpcmRXZWlnaHRGZWUnKS5nZXQoMCk7XHJcbiAgICAgICAgbGV0IGlzaGFzVGF4TGlzdCA9ICQoXCIuaXNoYXNfdGF4XCIpLmdldCgpO1xyXG5cclxuICAgICAgICAvLyBMb2dpYyAgICAgICAgXHJcbiAgICAgICAgLy9mdWxsV2VpZ2h0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5DYWN1bGF0ZUFsbEZlZSk7XHJcbiAgICAgICAgLy9kZWZlY3RpdmVXZWlnaHQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLkNhY3VsYXRlQWxsRmVlKTtcclxuICAgICAgICAvL3VuaXRQcmljZS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuQ2FjdWxhdGVBbGxGZWUpO1xyXG4gICAgICAgIC8vdHJhZmljVW5pdFByaWNlLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5DYWN1bGF0ZUFsbEZlZSk7XHJcbiAgICAgICAgLy93ZWlnaHRGZWUuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLkNhY3VsYXRlQWxsRmVlKTtcclxuICAgICAgICAvL2lzaGFzVGF4TGlzdC5mb3JFYWNoKChpdGVtKSA9PiBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuQ2FjdWxhdGVBbGxGZWUpKTtcclxuICAgIH07XHJcblxyXG4gICAgcHVibGljIFJlU2V0Q2FyTm9JdGVtcyhjYXJOb0lkT2JqOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBkYXRhT2JqTHMpIHtcclxuICAgICAgICBjYXJOb0lkT2JqLmh0bWwoJycpOyAgLy8g6YG46aCF5riF56m6XHJcbiAgICAgICAgbGV0IGRlZmF1bHRPcHRpb24gPSBuZXcgT3B0aW9uKFwiMC7mlrDou4rniYxcIiwgXCIwXCIsIGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgICAgY2FyTm9JZE9iai5hcHBlbmQoZGVmYXVsdE9wdGlvbik7XHJcbiAgICAgICAgZGF0YU9iakxzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsgIC8vIOa4heWWrumgheebrlxyXG4gICAgICAgICAgICBsZXQgbmV3T3B0aW9uID0gbmV3IE9wdGlvbihpdGVtLmNhck5hbWUsIGl0ZW0uaWQsIGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGNhck5vSWRPYmouYXBwZW5kKG5ld09wdGlvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyBTaG93TGlzdCgpIHtcclxuXHJcbiAgICAgICAgLy8g5YKz5YWl57WQ5p6cIOagueaTmue1kOaenOaqouafpeaYr+WQpueCuuaWsOWinuS4jeeCuuaWsOWinueahOWJh1Bhc3PvvIzkuI3lho3kv53nlZnmuIXllq7nmoTliYfnp7vpmaRcclxuXHJcblxyXG4gICAgICAgIC8vbGV0IHVzZXJTZWxlY3QgPSAoJCgnLnNlbGVjdDJiczQnKS5maW5kKCc6c2VsZWN0ZWQnKS5nZXQoKSBhcyBIVE1MU2VsZWN0RWxlbWVudFtdKTtcclxuICAgICAgICAvLyBVc2Vy55Wr6Z2i5omA6YG4XHJcbiAgICAgICAgbGV0IHVzZXJTZWxlY3QgPSAkKCcuc2VsZWN0MmJzNCcpLmZpbmQoJzpzZWxlY3RlZCcpLnRvQXJyYXkoKSBhcyBIVE1MU2VsZWN0RWxlbWVudFtdO1xyXG5cclxuICAgICAgICAvLyDmupblgpnopoFTaG93XHJcbiAgICAgICAgbGV0IHNob3dMaXN0ID0gJCgnI2V2ZW5Qcm9kdWN0THMgbGknKS50b0FycmF5KCkuY29uY2F0KCQoJyNvZGRQcm9kdWN0THMgbGknKS50b0FycmF5KCkpIGFzIEhUTUxMSUVsZW1lbnRbXTtcclxuXHJcblxyXG5cclxuICAgICAgICAvLyDopoHmlrDlop7nmoTlsLHmlrDlop5cclxuICAgICAgICB1c2VyU2VsZWN0LmZpbHRlcihpdGVtID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHNob3dMaXN0Lm1hcChsaXRhZyA9PiBsaXRhZy5kYXRhc2V0LnZhbHVlKS5pbmRleE9mKGl0ZW0udmFsdWUpID09PSAtMTtcclxuICAgICAgICB9KS5mb3JFYWNoKChpdGVtKSA9PiB0aGlzLkFwcGVuZFRvU2hvd0xpc3QoaXRlbSkpO1xyXG4gICAgICAgIC8vIOimgeWIqumZpOeahOWwseWIqumZpCAgICBcclxuICAgICAgICBzaG93TGlzdC5maWx0ZXIobGl0YWcgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdXNlclNlbGVjdC5tYXAoaXRlbSA9PiBpdGVtLnZhbHVlKS5pbmRleE9mKGxpdGFnLmRhdGFzZXQudmFsdWUpID09PSAtMTtcclxuICAgICAgICB9KS5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5yZW1vdmUoKSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyBTaG93TGlzdDIodXNlclNlbGVjdGVkVmFsczogc3RyaW5nW10sXHJcbiAgICAgICAgZXZlblByb2R1Y3RMaVRhZ0xzOiBIVE1MTElFbGVtZW50W10sXHJcbiAgICAgICAgb2RkUHJvZHVjdExpVGFnTHM6IEhUTUxMSUVsZW1lbnRbXSkge1xyXG5cclxuICAgICAgICAvLyDlgrPlhaXntZDmnpwg5qC55pOa57WQ5p6c5qqi5p+l5piv5ZCm54K65paw5aKe5LiN54K65paw5aKe55qE5YmHUGFzc++8jOS4jeWGjeS/neeVmea4heWWrueahOWJh+enu+mZpFxyXG5cclxuXHJcbiAgICAgICAgLy8gVXNlcueVq+mdouaJgOmBuFxyXG4gICAgICAgIGxldCB1c2VyU2VsZWN0ID0gJCgnLnNlbGVjdDJiczQnKS5maW5kKCc6c2VsZWN0ZWQnKS50b0FycmF5KCk7XHJcbiAgICAgICAgbGV0IHVzZXJTZWxlY3QyID0gKCQoJy5zZWxlY3QyYnM0JykuZmluZCgnOnNlbGVjdGVkJykudG9BcnJheSgpIGFzIEhUTUxPcHRpb25FbGVtZW50W10pXHJcbiAgICAgICAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLnZhbHVlKTtcclxuXHJcblxyXG5cclxuICAgICAgICAvLyDlt67pm4ZcclxuICAgICAgICAvLyDopoHmlrDlop7nmoTlsLHmlrDlop5cclxuICAgICAgICAvL3VzZXJTZWxlY3QuZmlsdGVyKGl0ZW0gPT4ge1xyXG4gICAgICAgIC8vICAgIHJldHVybiBzaG93TGlzdC5tYXAobGl0YWcgPT4gbGl0YWcuZGF0YXNldC52YWx1ZSkuaW5kZXhPZihpdGVtLnZhbHVlKSA9PT0gLTE7XHJcbiAgICAgICAgLy99KS5mb3JFYWNoKChpdGVtKSA9PiB0aGlzLkFwcGVuZFRvU2hvd0xpc3QoaXRlbSkpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXJTZWxlY3QyKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIEdldFNob3dQcm9kSXRlbUlkcyh0ZXN0UG9zdE9iajogSlF1ZXJ5PEhUTUxEaXZFbGVtZW50Pik6IHN0cmluZ1tdIHtcclxuXHJcbiAgICAgICAgY29uc3QgYWxsU2hvd0xpc3QgPSAkKFwiI2V2ZW5Qcm9kdWN0THMgbGlcIikudG9BcnJheSgpLmNvbmNhdChcclxuICAgICAgICAgICAgJChcIiNvZGRQcm9kdWN0THMgbGlcIikudG9BcnJheSgpKSBhcyBIVE1MTElFbGVtZW50W107XHJcblxyXG4gICAgICAgIGlmIChhbGxTaG93TGlzdCkge1xyXG4gICAgICAgICAgICAvL2xldCBhYmMzID0gYWxsU2hvd0xpc3QuZmlsdGVyKChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAvLyAgICB2YWx1ZVByb3BlcnR5LnZhbHVlID0gdGhlTGkuXHJcbiAgICAgICAgICAgIC8vICAgIHJldHVybiBpdGVtLm5hbWUuaW5jbHVkZXMoXCJQcm9kdWN0SWRcIik7XHJcbiAgICAgICAgICAgIC8vfSkubWFwKGl0ZW0gPT4gaXRlbS52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgYWJjMyA9IGFsbFNob3dMaXN0Lm1hcChpdGVtID0+IHsgcmV0dXJuIGl0ZW0uZGF0YXNldC52YWx1ZSB9KVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGFiYzNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vbGV0IHNob0xpc3QgPSB0ZXN0UG9zdE9iai5maW5kKCdpbnB1dCcpLnRvQXJyYXkoKTtcclxuICAgICAgICAvL2lmIChzaG9MaXN0KSB7XHJcblxyXG4gICAgICAgIC8vICAgIGxldCBhYmMyID0gc2hvTGlzdC5maWx0ZXIoKGl0ZW0sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgIHJldHVybiBpdGVtLm5hbWUuaW5jbHVkZXMoXCJQcm9kdWN0SWRcIik7XHJcbiAgICAgICAgLy8gICAgfSkubWFwKGl0ZW0gPT4gaXRlbS52YWx1ZSk7XHJcblxyXG5cclxuICAgICAgICAvLyAgICAvL2xldCBhYmMgPSBzaG9MaXN0Lm1hcCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAvLyAgICAvLyAgICByZXR1cm4gKGl0ZW0ubmFtZS5xdWVyeVNlbGVjdG9yKGBpbnB1dFtuYW1lPVwiVkVfUHVyY2hhc2VJbmdyZWRpZW50THNbJHtpbmRleH1dLlByb2R1Y3RJZFwiYCkgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWU7XHJcbiAgICAgICAgLy8gICAgLy99KVxyXG5cclxuICAgICAgICAvLyAgICByZXR1cm4gYWJjMjtcclxuICAgICAgICAvL31cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHVibGljIEFwcGVuZFRvU2hvd0xpc3QocHJvZEl0ZW06IEhUTUxTZWxlY3RFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgYWxsU2hvd0xpc3QgPSAkKFwiI2V2ZW5Qcm9kdWN0THMgbGlcIikudG9BcnJheSgpLmNvbmNhdCgkKFwiI29kZFByb2R1Y3RMcyBsaVwiKS50b0FycmF5KCkpO1xyXG5cclxuXHJcbiAgICAgICAgY29uc3QgaU1pbnVzVGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlcIik7XHJcbiAgICAgICAgaU1pbnVzVGFnLmNsYXNzTGlzdC5hZGQoXCJmYXNcIik7XHJcbiAgICAgICAgaU1pbnVzVGFnLmNsYXNzTGlzdC5hZGQoXCJmYS1taW51cy1jaXJjbGVcIik7XHJcbiAgICAgICAgaU1pbnVzVGFnLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xyXG4gICAgICAgIGlNaW51c1RhZy5zdHlsZS5jb2xvciA9IFwiYmx1ZVwiO1xyXG4gICAgICAgIGNvbnN0IGlQbHVzVGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlcIik7XHJcbiAgICAgICAgaVBsdXNUYWcuY2xhc3NMaXN0LmFkZChcImZhc1wiKTtcclxuICAgICAgICBpUGx1c1RhZy5jbGFzc0xpc3QuYWRkKFwiZmEtcGx1cy1jaXJjbGVcIik7XHJcbiAgICAgICAgaVBsdXNUYWcuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XHJcbiAgICAgICAgaVBsdXNUYWcuc3R5bGUuY29sb3IgPSBcInJlZFwiO1xyXG4gICAgICAgIGNvbnN0IHNwYW5UYWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKSBhcyBIVE1MU3BhbkVsZW1lbnQ7XHJcblxyXG5cclxuICAgICAgICBjb25zdCBsaVRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKSBhcyBIVE1MTElFbGVtZW50O1xyXG4gICAgICAgIGxpVGFnLmRhdGFzZXQudGV4dCA9IHByb2RJdGVtLnRleHRDb250ZW50O1xyXG4gICAgICAgIGxpVGFnLnRleHRDb250ZW50ID0gYCR7cHJvZEl0ZW0udGV4dENvbnRlbnR9IFxcdTAwQTBcXHUwMEEwYDtcclxuICAgICAgICBsaVRhZy5kYXRhc2V0LnZhbHVlID0gcHJvZEl0ZW0udmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICBsaVRhZy5kYXRhc2V0LnBlcmNlbnQgPSBhbGxTaG93TGlzdC5sZW5ndGggPT09IDAgPyBcIjkwXCIgOiBcIjEwXCI7XHJcbiAgICAgICAgbGlUYWcuYXBwZW5kQ2hpbGQoaU1pbnVzVGFnKTtcclxuICAgICAgICBsaVRhZy5hcHBlbmRDaGlsZChzcGFuVGFnKTtcclxuICAgICAgICBsaVRhZy5hcHBlbmRDaGlsZChpUGx1c1RhZyk7XHJcblxyXG5cclxuICAgICAgICAvL0FkZEhpZGRlbihsaVRhZywgaW5kZXgpO1xyXG5cclxuICAgICAgICAvLyBBY3Rpb24gICAgXHJcbiAgICAgICAgY29uc3Qgc2hvd0xpc3QgPSBhbGxTaG93TGlzdC5sZW5ndGggJSAyID09PSAwID9cclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJldmVuUHJvZHVjdExzXCIpIDpcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvZGRQcm9kdWN0THNcIik7XHJcbiAgICAgICAgc2hvd0xpc3Q/LmFwcGVuZENoaWxkKGxpVGFnKTtcclxuXHJcbiAgICAgICAgbGV0IGFsbFNob3dMaXN0MiA9ICQoXCIjZXZlblByb2R1Y3RMcyBsaVwiKS50b0FycmF5KCkuY29uY2F0KCQoXCIjb2RkUHJvZHVjdExzIGxpXCIpLnRvQXJyYXkoKSlcclxuICAgICAgICBhbGxTaG93TGlzdDIuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgQXJyYXkuZnJvbShpdGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpKS5mb3JFYWNoKHN1Ykl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgc3ViSXRlbS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBBZGRIaWRkZW4oaXRlbSBhcyBIVE1MTElFbGVtZW50LCBpbmRleCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vRXZlbnRcclxuICAgICAgICBsZXQgdGhpc09iaiA9IHRoaXM7XHJcbiAgICAgICAgaU1pbnVzVGFnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsZXQgbm93TElUYWcgPSB0aGlzLnBhcmVudEVsZW1lbnQgYXMgSFRNTExJRWxlbWVudDtcclxuICAgICAgICAgICAgdGhpc09iai5DYWN1bGF0ZVBlcmNlbnQobm93TElUYWcsIGZhbHNlKTtcclxuICAgICAgICAgICAgdGhpc09iai5SZWZyZXNoUHJvZEl0ZW1QZXJjZW50KCk7XHJcbiAgICAgICAgICAgIHRoaXNPYmouU2hvd1RvdGFsSW5mbygpO1xyXG4gICAgICAgICAgICB0aGlzT2JqLlNldEJpbmRpbmdWYWx1ZSgpO1xyXG4gICAgICAgICAgICBsZXQgYWxsU2hvd0xpc3QzID0gJChcIiNldmVuUHJvZHVjdExzIGxpXCIpLnRvQXJyYXkoKS5jb25jYXQoJChcIiNvZGRQcm9kdWN0THMgbGlcIikudG9BcnJheSgpKVxyXG4gICAgICAgICAgICBhbGxTaG93TGlzdDMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgIEFycmF5LmZyb20oaXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKSkuZm9yRWFjaChzdWJJdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBzdWJJdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpc09iai5BZGRIaWRkZW4oaXRlbSBhcyBIVE1MTElFbGVtZW50LCBpbmRleCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpUGx1c1RhZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGV0IG5vd0xJVGFnID0gdGhpcy5wYXJlbnRFbGVtZW50IGFzIEhUTUxMSUVsZW1lbnRcclxuICAgICAgICAgICAgdGhpc09iai5DYWN1bGF0ZVBlcmNlbnQobm93TElUYWcsIHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzT2JqLlJlZnJlc2hQcm9kSXRlbVBlcmNlbnQoKTtcclxuICAgICAgICAgICAgdGhpc09iai5TaG93VG90YWxJbmZvKCk7XHJcbiAgICAgICAgICAgIHRoaXNPYmouU2V0QmluZGluZ1ZhbHVlKCk7XHJcbiAgICAgICAgICAgIGxldCBhbGxTaG93TGlzdDQgPSAkKFwiI2V2ZW5Qcm9kdWN0THMgbGlcIikudG9BcnJheSgpLmNvbmNhdCgkKFwiI29kZFByb2R1Y3RMcyBsaVwiKS50b0FycmF5KCkpXHJcbiAgICAgICAgICAgIGFsbFNob3dMaXN0NC5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgQXJyYXkuZnJvbShpdGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpKS5mb3JFYWNoKHN1Ykl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Ykl0ZW0ucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzT2JqLkFkZEhpZGRlbihpdGVtIGFzIEhUTUxMSUVsZW1lbnQsIGluZGV4KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHB1YmxpYyBBcHBlbmRUb1Nob3dMaXN0Mihwcm9kSXRlbTogSFRNTFNlbGVjdEVsZW1lbnQpIHtcclxuICAgIH07XHJcblxyXG4gICAgcHVibGljIFJlZnJlc2hQcm9kSXRlbVBlcmNlbnQoKSB7XHJcbiAgICAgICAgbGV0IGFsbFByb2RJdGVtcyA9ICQoJyNldmVuUHJvZHVjdExzIGxpJykudG9BcnJheSgpLmNvbmNhdChcclxuICAgICAgICAgICAgJCgnI29kZFByb2R1Y3RMcyBsaScpLnRvQXJyYXkoKSkgYXMgSFRNTExJRWxlbWVudFtdO1xyXG5cclxuICAgICAgICBhbGxQcm9kSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICBsZXQgc3BhblRhZyA9IGl0ZW0ucXVlcnlTZWxlY3RvcihcInNwYW5cIik7XHJcbiAgICAgICAgICAgIHNwYW5UYWcuaW5uZXJIVE1MID0gYFxcdTAwQTBcXHUwMEEwJHtpdGVtLmRhdGFzZXQucGVyY2VudH0lXFx1MDBBMFxcdTAwQTBgXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIEFkZEhpZGRlbih0aGVMaTogSFRNTExJRWxlbWVudCwgaW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIC8vIENyZWF0ZSBhIGhpZGRlbiBpbnB1dCBlbGVtZW50LCBhbmQgYXBwZW5kIGl0IHRvIHRoZSBsaTpcclxuICAgICAgICBsZXQgbmFtZVByb3BlcnR5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgIG5hbWVQcm9wZXJ0eS5jbGFzc05hbWUgPSBcIm1vZGVsYmluZFwiXHJcbiAgICAgICAgbmFtZVByb3BlcnR5LnR5cGUgPSBcImhpZGRlblwiO1xyXG4gICAgICAgIG5hbWVQcm9wZXJ0eS5uYW1lID0gYFZFX1B1cmNoYXNlSW5ncmVkaWVudExzWyR7aW5kZXh9XS5JdGVtTmFtZWA7XHJcbiAgICAgICAgbmFtZVByb3BlcnR5LnZhbHVlID0gdGhlTGkuZGF0YXNldC50ZXh0XHJcbiAgICAgICAgbGV0IHZhbHVlUHJvcGVydHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgbmFtZVByb3BlcnR5LmNsYXNzTmFtZSA9IFwibW9kZWxiaW5kXCJcclxuICAgICAgICB2YWx1ZVByb3BlcnR5LnR5cGUgPSBcImhpZGRlblwiO1xyXG4gICAgICAgIHZhbHVlUHJvcGVydHkubmFtZSA9IGBWRV9QdXJjaGFzZUluZ3JlZGllbnRMc1ske2luZGV4fV0uUHJvZHVjdElkYDtcclxuICAgICAgICB2YWx1ZVByb3BlcnR5LnZhbHVlID0gdGhlTGkuZGF0YXNldC52YWx1ZVxyXG4gICAgICAgIGxldCBwZXJjZW50UHJvcGVydHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgbmFtZVByb3BlcnR5LmNsYXNzTmFtZSA9IFwibW9kZWxiaW5kXCJcclxuICAgICAgICBwZXJjZW50UHJvcGVydHkudHlwZSA9IFwiaGlkZGVuXCI7XHJcbiAgICAgICAgcGVyY2VudFByb3BlcnR5Lm5hbWUgPSBgVkVfUHVyY2hhc2VJbmdyZWRpZW50THNbJHtpbmRleH1dLkl0ZW1QZXJjZW50YDtcclxuICAgICAgICBwZXJjZW50UHJvcGVydHkudmFsdWUgPSB0aGVMaS5kYXRhc2V0LnBlcmNlbnRcclxuXHJcbiAgICAgICAgdGhlTGkuYXBwZW5kQ2hpbGQobmFtZVByb3BlcnR5KTtcclxuICAgICAgICB0aGVMaS5hcHBlbmRDaGlsZCh2YWx1ZVByb3BlcnR5KTtcclxuICAgICAgICB0aGVMaS5hcHBlbmRDaGlsZChwZXJjZW50UHJvcGVydHkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBTaG93VG90YWxJbmZvKCkge1xyXG4gICAgICAgIGxldCBhbGxQcm9kSXRlbXMgPSAkKCcjZXZlblByb2R1Y3RMcyBsaScpLnRvQXJyYXkoKS5jb25jYXQoXHJcbiAgICAgICAgICAgICQoJyNvZGRQcm9kdWN0THMgbGknKS50b0FycmF5KCkpIGFzIEhUTUxMSUVsZW1lbnRbXTtcclxuXHJcbiAgICAgICAgbGV0IGFsbFBlcmNlbnQgPSAwO1xyXG4gICAgICAgIGxldCBtYXhJdGVtOiBIVE1MTElFbGVtZW50O1xyXG4gICAgICAgIGFsbFByb2RJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgIGFsbFBlcmNlbnQgPSArIGl0ZW0uZGF0YXNldC5wZXJjZW50ICsgYWxsUGVyY2VudDtcclxuICAgICAgICAgICAgaWYgKCFtYXhJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBtYXhJdGVtID0gaXRlbTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG1heEl0ZW0gPSArbWF4SXRlbS5kYXRhc2V0LnBlcmNlbnQgPiAraXRlbS5kYXRhc2V0LnBlcmNlbnQgPyBtYXhJdGVtIDogaXRlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCB0b3RhbEluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvdGFsXCIpO1xyXG4gICAgICAgIHRvdGFsSW5mby5xdWVyeVNlbGVjdG9yQWxsKFwic3BhblwiKS5mb3JFYWNoKGl0ZW0gPT4geyBpdGVtLnJlbW92ZSgpIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBpdGVtU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG4gICAgICAgIGl0ZW1TcGFuLmlubmVySFRNTCA9IGDvvIzlt7Lpgbgke2FsbFByb2RJdGVtcy5sZW5ndGh96aCFYDtcclxuICAgICAgICBjb25zdCBwZXJjZW50U3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG4gICAgICAgIHBlcmNlbnRTcGFuLmlubmVySFRNTCA9IGDvvIzmr5TkvovliqDnuL06JHthbGxQZXJjZW50fSVgXHJcbiAgICAgICAgaWYgKGFsbFBlcmNlbnQgPiAxMDApXHJcbiAgICAgICAgICAgIHBlcmNlbnRTcGFuLnN0eWxlLmNvbG9yID0gXCJyZWRcIjtcclxuICAgICAgICBjb25zdCByZWNvZ25pdGlvblNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcclxuXHJcbiAgICAgICAgLy9sZXQgaGFoYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWxlY3QyYnM0IDpjaGVja2VkJykgYXMgSFRNTE9wdGlvbkVsZW1lbnQ7XHJcbiAgICAgICAgLy9hbGVydChoYWhhLnZhbHVlKTtcclxuXHJcbiAgICAgICAgLy9sZXQgcmVjb2duaXRpb25UZXh0ID0gKCQoJy5zZWxlY3QyYnM0JykuZmluZCgnOnNlbGVjdGVkJykudG9BcnJheSgpIGFzIEhUTUxTZWxlY3RFbGVtZW50W10pXHJcbiAgICAgICAgLy8gICAgLmZpbHRlcihpdGVtID0+IHsgcmV0dXJuIGl0ZW0udmFsdWUgPT09IG1heEl0ZW0uZGF0YXNldC52YWx1ZTsgfSlbMF0/LnRleHRDb250ZW50ID8/IFwi54ShXCI7XHJcbiAgICAgICAgcmVjb2duaXRpb25TcGFuLmlubmVySFRNTCA9IGDoqo3liJfpoIXnm64gOiAke21heEl0ZW0/LmRhdGFzZXQudGV4dCA/PyBcIueEoVwifWBcclxuXHJcbiAgICAgICAgdG90YWxJbmZvLmFwcGVuZENoaWxkKHJlY29nbml0aW9uU3Bhbik7XHJcbiAgICAgICAgdG90YWxJbmZvLmFwcGVuZENoaWxkKGl0ZW1TcGFuKTtcclxuICAgICAgICB0b3RhbEluZm8uYXBwZW5kQ2hpbGQocGVyY2VudFNwYW4pO1xyXG5cclxuICAgICAgICBpZiAoYWxsUHJvZEl0ZW1zLmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICQoJyNJc1Bhc3NQdXJjaGFzZScpLnZhbChcInRydWVcIik7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAkKCcjSXNQYXNzUHVyY2hhc2UnKS52YWwoXCJmYWxzZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgU2V0QmluZGluZ1ZhbHVlKCkge1xyXG5cclxuICAgICAgICBsZXQgYWxsUHJvZEl0ZW1zID0gJCgnI2V2ZW5Qcm9kdWN0THMgbGknKS50b0FycmF5KCkuY29uY2F0KFxyXG4gICAgICAgICAgICAkKCcjb2RkUHJvZHVjdExzIGxpJykudG9BcnJheSgpKSBhcyBIVE1MTElFbGVtZW50W107XHJcblxyXG4gICAgICAgIGxldCBwdXJjaGFzZURldGFpbEluZm9zOiBQdXJjaGFzZURldGFpbEluZm8yW10gPSBbXTtcclxuICAgICAgICBhbGxQcm9kSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICBsZXQgcHVyY2hhc2VEZXRhaWxJbmZvID0gbmV3IFB1cmNoYXNlRGV0YWlsSW5mbzIoKTtcclxuICAgICAgICAgICAgcHVyY2hhc2VEZXRhaWxJbmZvLlZhbHVlID0gaXRlbS5kYXRhc2V0LnZhbHVlO1xyXG4gICAgICAgICAgICBwdXJjaGFzZURldGFpbEluZm8uTmFtZSA9IGl0ZW0udGV4dENvbnRlbnQ7XHJcbiAgICAgICAgICAgIHB1cmNoYXNlRGV0YWlsSW5mby5QZXJjZW50ID0gcGFyc2VJbnQoaXRlbS5kYXRhc2V0LnBlcmNlbnQsIDEwKTtcclxuICAgICAgICAgICAgcHVyY2hhc2VEZXRhaWxJbmZvcy5wdXNoKHB1cmNoYXNlRGV0YWlsSW5mbyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHB1cmNoYXNlRGV0YWlsSW5mb3MubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICAkKCcjU2VsZWN0UHVyY2hhc2VEZXRhaWxJbmZvcycpLnZhbChudWxsKTtcclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgJCgnI1NlbGVjdFB1cmNoYXNlRGV0YWlsSW5mb3MnKS52YWwoSlNPTi5zdHJpbmdpZnkocHVyY2hhc2VEZXRhaWxJbmZvcykpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIENhY3VsYXRlUGVyY2VudChjdXJQcm9kSXRlbTogSFRNTExJRWxlbWVudCwgaXNQbHVzOiBib29sZWFuKSB7XHJcbiAgICAgICAgY29uc3QgY3VyVmFsID0gY3VyUHJvZEl0ZW0uZGF0YXNldC5wZXJjZW50O1xyXG4gICAgICAgIGxldCBuZXdWYWw6IG51bWJlciA9IGlzUGx1cyA/ICtjdXJWYWwgKyAxMCA6ICtjdXJWYWwgLSAxMDtcclxuICAgICAgICBpZiAobmV3VmFsID4gMTAwKVxyXG4gICAgICAgICAgICBuZXdWYWwgPSAxMDA7XHJcbiAgICAgICAgaWYgKG5ld1ZhbCA8IDApXHJcbiAgICAgICAgICAgIG5ld1ZhbCA9IDA7XHJcbiAgICAgICAgY3VyUHJvZEl0ZW0uZGF0YXNldC5wZXJjZW50ID0gbmV3VmFsLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgLy92YXIgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm91dHNpZGVcIik7XHJcbiAgICAgICAgLy9lbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgbW9kaWZ5VGV4dCwgZmFsc2UpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuY2xhc3MgUHVyY2hhc2VEZXRhaWxJbmZvMiB7XHJcbiAgICBWYWx1ZTogc3RyaW5nO1xyXG4gICAgTmFtZTogc3RyaW5nO1xyXG4gICAgUGVyY2VudDogbnVtYmVyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdfQ==